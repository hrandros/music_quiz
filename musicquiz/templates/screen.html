{% extends "base.html" %}
{% block title %}TV Screen{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
<style>
    /* Sakrij navigaciju jer je ovo TV ekran */
    nav, footer { display: none !important; } 
    body { background-color: #000; overflow: hidden; height: 100vh; }
    
    /* Stilovi za Top Listu */
    .lb-row {
        font-size: 1.8rem; 
        padding: 15px; 
        border-bottom: 1px solid #333;
        font-family: 'Oswald', sans-serif;
    }
    .lb-row:first-child { background-color: #1a1a1a; color: #ffc107; font-size: 2.2rem; border-left: 5px solid #ffc107; }
    
    /* Stilovi za lijevu stranu (Info) */
    .info-box {
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }

    /* --- NOVI CSS ZA VIZUALIZATOR --- */
    .visualizer-container {
        display: flex;
        justify-content: center;
        align-items: flex-end;
        height: 180px; /* Visina vizualizatora */
        gap: 8px;      /* Razmak između stupaca */
    }

    .bar {
        width: 20px;
        background: linear-gradient(to top, #dc3545, #ffc107); /* Crveno-žuti gradijent */
        border-radius: 4px 4px 0 0;
        /* Defaultna animacija (dok svira) */
        animation: equalize 0.8s ease-in-out infinite alternate;
        height: 10%; /* Početna visina */
    }

    /* Različite brzine za "random" efekt */
    .bar:nth-child(1) { animation-duration: 0.7s; animation-delay: 0.1s; }
    .bar:nth-child(2) { animation-duration: 1.1s; animation-delay: 0.3s; }
    .bar:nth-child(3) { animation-duration: 0.9s; animation-delay: 0.0s; }
    .bar:nth-child(4) { animation-duration: 1.3s; animation-delay: 0.4s; }
    .bar:nth-child(5) { animation-duration: 0.8s; animation-delay: 0.2s; }
    .bar:nth-child(6) { animation-duration: 1.2s; animation-delay: 0.5s; }
    .bar:nth-child(7) { animation-duration: 1.0s; animation-delay: 0.1s; }

    /* Keyframes za skakanje */
    @keyframes equalize {
        0% { height: 15%; opacity: 0.7; }
        100% { height: 100%; opacity: 1; box-shadow: 0 0 15px #dc3545; }
    }

    /* Klasa koja pauzira animaciju (kad ne svira) */
    .paused .bar {
        animation-play-state: paused;
        height: 10% !important; /* Spusti ih dolje */
        opacity: 0.3;
        box-shadow: none;
        transition: height 0.5s ease, opacity 0.5s ease;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid h-100 p-0">
    <div class="row h-100 g-0">
        
        <div class="col-7 bg-black text-white position-relative border-end border-secondary">
            
            <div class="position-absolute top-0 start-0 p-4">
                <h1 class="fw-bold text-danger" style="font-family:'Oswald'; font-size:2.5rem;">
                    {{ quiz.info.title }}
                </h1>
                <h3 class="text-white">RUNDA <span id="roundDisplay">1</span></h3>
            </div>

            <div class="info-box">
                <div id="visualizer" class="mb-5 visualizer-container paused">
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>
                </div>

                <h1 id="songDisplay" class="display-1 fw-bold text-white mb-3" style="font-family: 'Oswald';">
                    ČEKAM...
                </h1>

                <h3 id="statusLabel" class="text-muted text-uppercase letter-spacing-2">PRIPREMA</h3>
                
                <div id="ansKey" class="d-none w-75 mt-4 text-start"></div>
            </div>
            
            <div id="timerOverlay" class="d-none position-absolute top-50 start-50 translate-middle text-danger fw-bold" style="font-size: 15rem; text-shadow: 0 0 50px red;">
                30
            </div>
        </div>

        <div class="col-5 bg-dark border-start border-secondary">
            <div class="p-4 h-100 d-flex flex-column">
                <h2 class="text-white border-bottom border-secondary pb-3 mb-0" style="font-family: 'Oswald';">
                    <i class="bi bi-trophy-fill text-warning me-2"></i> POREDAK
                </h2>
                <div id="lbContent" class="flex-grow-1 overflow-hidden mt-2">
                    </div>
            </div>
        </div>

    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/screen.js') }}"></script>
{% endblock %}