
{% extends "base.html" %}
{% block title %}TV Screen{% endblock %}

{% block extra_head %}
<style>
  /* Sakrij navigaciju i footer na TV ekranu */
  nav, footer { display: none !important; }
  body { background-color: #000; overflow: hidden; height: 100vh; }

  /* Leaderboard */
  .lb-row {
    font-size: 1.8rem;
    padding: 15px;
    border-bottom: 1px solid #333;
    font-family: 'Oswald', sans-serif;
  }
  .lb-row:first-child {
    background-color: #1a1a1a; color: #ffc107; font-size: 2.2rem; border-left: 5px solid #ffc107;
  }

  /* Lijevi infobox */
  .info-box {
    height: 100%;
    display: flex; flex-direction: column;
    justify-content: center; align-items: center;
  }

  /* Vizualizator (ekvalizator) */
  .visualizer-container {
    display: flex; justify-content: center; align-items: flex-end;
    height: 180px; gap: 8px;
  }
  .bar {
    width: 20px; background: linear-gradient(to top, #dc3545, #ffc107);
    border-radius: 4px 4px 0 0;
    animation: equalize 0.8s ease-in-out infinite alternate;
    height: 10%;
  }
  .bar:nth-child(1){animation-duration:.7s; animation-delay:.1s;}
  .bar:nth-child(2){animation-duration:1.1s; animation-delay:.3s;}
  .bar:nth-child(3){animation-duration:.9s; animation-delay:0s;}
  .bar:nth-child(4){animation-duration:1.3s; animation-delay:.4s;}
  .bar:nth-child(5){animation-duration:.8s; animation-delay:.2s;}
  .bar:nth-child(6){animation-duration:1.2s; animation-delay:.5s;}
  .bar:nth-child(7){animation-duration:1.0s; animation-delay:.1s;}

  @keyframes equalize {
    0% { height: 15%; opacity: .7; }
    100% { height: 100%; opacity: 1; box-shadow: 0 0 15px #dc3545; }
  }
  .paused .bar {
    animation-play-state: paused;
    height: 10% !important; opacity: .3; box-shadow: none;
    transition: height .5s ease, opacity .5s ease;
  }

  /* Player list (TV) */
  #playersList {
    padding-top: 1rem;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    align-items: flex-start;
    max-height: 28vh;
    overflow: hidden;
  }

  #playersList .player {
    display: inline-flex;
    align-items: center;
    gap: 0.75rem;
  }

  #playersList .dot {
    width: 14px;
    height: 14px;
    border-radius: 50%;
    flex: 0 0 14px;
    box-shadow: 0 0 6px rgba(0,0,0,0.4);
  }

  #playersList .name-badge {
    font-size: 1.1rem;
    padding: 0.35rem 0.7rem;
    background: #343a40;
    color: #fff;
    border-radius: 0.35rem;
    display: inline-block;
    max-width: 160px;
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
  }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid h-100 p-0">
  <div class="row h-100 g-0">

    <!-- Lijevi panel -->
    <div class="col-7 bg-black text-white position-relative border-end border-secondary">
      <div class="position-absolute top-0 start-0 p-4">
        <h1 class="fw-bold text-danger" style="font-family:'Oswald'; font-size:2.5rem;">
          {{ quiz.info.title }}
        </h1>
        <h3 class="text-white">RUNDA <span id="roundDisplay">1</span></h3>
      </div>

      <div class="info-box">
        <div id="visualizer" class="mb-5 visualizer-container paused">
          <div class="bar"></div>
          <div class="bar"></div>
          <div class="bar"></div>
          <div class="bar"></div>
          <div class="bar"></div>
          <div class="bar"></div>
          <div class="bar"></div>
        </div>

        <h1 id="songDisplay" class="display-1 fw-bold text-white mb-3" style="font-family: 'Oswald';">
          ČEKAM...
        </h1>
        <h3 id="statusLabel" class="text-muted text-uppercase">PRIPREMA</h3>

        <div id="ansKey" class="d-none w-75 mt-4 text-start"></div>
      </div>

      <div id="timerOverlay"
           class="d-none position-absolute top-50 start-50 translate-middle text-danger fw-bold"
           style="font-size: 15rem; text-shadow: 0 0 50px red;">
        30
      </div>
    </div>

    <!-- Desni panel: leaderboard -->
    <div class="col-5 bg-dark border-start border-secondary">
      <div class="p-4 h-100 d-flex flex-column">
        <h2 class="text-white border-bottom border-secondary pb-3 mb-0" style="font-family: 'Oswald';">
          <i class="bi bi-trophy-fill text-warning me-2" aria-hidden="true"></i> POREDAK
        </h2>
        <!-- Prikaz prijavljenih igrača -->
        <div id="playersList" class="mt-3 mb-2"></div>

        <div id="lbContent" class="flex-grow-1 overflow-hidden mt-2"></div>
      </div>
    </div>

  </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/screen.js') }}"></script>
{% endblock %}
